{% extends "base.html" %}
{% block content %}

<h2>{{ 'Edit Customer' if customer else 'Add Customer' }}</h2>

<form method="POST" id="customerForm">

    <label>Customer Name</label>
    <input type="text" name="name" id="name" value="{{ customer.name if customer else '' }}" required>

    <label>Address</label>
    <input type="text" name="address" value="{{ customer.address if customer else '' }}">

    <label>Email</label>
    <input type="email" name="email" id="email" placeholder="abc@example.com"
           value="{{ customer.email if customer else '' }}">
    <p class="error" id="emailError"></p>

    <label>Phone Number</label>
    <input type="text" name="phone" id="phone" maxlength="10" placeholder="Enter 10 digits"
           value="{{ customer.phone if customer else '' }}">
    <p class="error" id="phoneError"></p>

    <label>Job</label>
    <input type="text" name="job" value="{{ customer.job if customer else '' }}">

    <label>Salary</label>
    <input type="number" name="salary" step="0.01" 
           value="{{ customer.salary if customer else '' }}">

    <button type="submit" id="submitBtn">Save Customer</button>
</form>


<style>
.error {
    color: red;
    font-size: 14px;
    margin-top: 2px;
}

input.invalid {
    border: 2px solid red;
}

input.valid {
    border: 2px solid green;
}
</style>

<script>
document.addEventListener("DOMContentLoaded", () => {

    const phone = document.getElementById("phone");
    const email = document.getElementById("email");
    const name = document.getElementById("name");
    const submitBtn = document.getElementById("submitBtn");

    // disable button initially
    submitBtn.disabled = true;

    function validateForm() {
        let valid = true;

        // PHONE VALIDATION
        if (!/^\d{10}$/.test(phone.value)) {
            document.getElementById("phoneError").innerText = "Phone must be exactly 10 digits.";
            phone.classList.add("invalid");
            phone.classList.remove("valid");
            valid = false;
        } else {
            document.getElementById("phoneError").innerText = "";
            phone.classList.add("valid");
            phone.classList.remove("invalid");
        }

        // EMAIL VALIDATION
        if (email.value && !/^\S+@\S+\.\S+$/.test(email.value)) {
            document.getElementById("emailError").innerText = "Invalid email format.";
            email.classList.add("invalid");
            email.classList.remove("valid");
            valid = false;
        } else {
            document.getElementById("emailError").innerText = "";
            email.classList.add("valid");
            email.classList.remove("invalid");
        }

        submitBtn.disabled = !valid;
    }

    phone.addEventListener("input", validateForm);
    email.addEventListener("input", validateForm);
    name.addEventListener("input", validateForm);

});
</script>

{% endblock %}
